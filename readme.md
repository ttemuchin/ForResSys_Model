100 образцов 
0,003-5 шума

лосс сейчас 0,14223

+ график отклонений пред/таргет
+ внедрить shared conv
+ создать десктоп. где будет запрос параметров базы и файла. потом заготовка модели

Текущая архитектура обрабатывала сигналы изолированно, поэтому.. 
Пробуем совместные сверточные слои (Shared Conv + Late Fusion).
Обрабатываем все сигналы через общие сверточные слои, объединив их по каналам.
=>Свертки учатся совместным паттернам across signals.
=>Экономия параметров за счет общих слоев.

Ключевая идея подхода Shared Convolution === разрозненные сигналы в многоканальный тензор

1.Общие сверточные слои:

Все сигналы объединяются по каналам (dim=1) в тензор [B, M, max_len].
////
B (Batch size) — количество образцов в батче (например, 32).
M (Number of experiments) — количество типов сигналов (например, 2: FID и CPMG).
max_len — длина самого длинного сигнала в наборе (например, 2000 точек для CPMG).
////

Свертки применяются к совокупности сигналов, что позволяет выявлять кросс-корреляции.

2.Динамический паддинг:

Сигналы дополняются нулями до максимальной длины в наборе.

Автоматически работает для любого количества входов (M) и их размеров.

3.Сохранение параметров:

Вместо M отдельных ветвей — одна общая сверточная сеть.

Число параметров сокращается с O(M) до O(1).

FID:  [B, 1, 1000] ───┐
                      ├─> [B, 2, 2000] (выход После Conv1d(M=2, filters=32, kernel_size=5) )
CPMG: [B, 1, 2000] ───┘

Модель автоматически масштабируется на любое M!

! Если качество упадет, добавить гибридный подход (общие свертки + индивидуальные ветви для ключевых сигналов).


Epoch 100
Train Loss: 0.0038 | Test Loss: 0.0016 | R² Score: 0.8218

Epoch 120
Train Loss: 0.0026 | Test Loss: 0.0007 | R² Score: 0.8725

Epoch 120
Train Loss: 0.0024 | Test Loss: 0.0015 | R² Score: 0.7373

Epoch 150
Train Loss: 0.0031 | Test Loss: 0.0008 | R² Score: 0.8849

на каком числе остановиться?

добавить механику стоп лосс ! фиксируем лучшее состояние. какое значение r2score можно считать удовлетворительным - 0,8 или 0,9? 
СДЕЛАТЬ ТО ЖЕ САМОЕ НА НЕЗАШУМЛЕННЫХ ШТУКАХ 
